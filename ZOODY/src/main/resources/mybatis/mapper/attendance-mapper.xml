<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="attendance">

	<select id="getMyAttendanceCnt" resultType="int">
		SELECT COUNT(NO)
		FROM ATTENDANCE
		WHERE NO=1
	</select>

	<select id="selectList" resultType="AttendanceVo">
		
		SELECT 
		    A.NO
		    ,A.USER_NO
		    ,A.CURRENT_NO
		    ,TO_CHAR(A.ENROLLDATE, 'YYYY-MM-DD') AS ENROLLDATE
		    ,TO_CHAR(A.CHECK_IN_TIME, 'HH24:MI:SS') AS CHECK_IN_TIME
		    ,TO_CHAR(A.CHECK_OUT_TIME, 'HH24:MI:SS') AS CHECK_OUT_TIME
		    ,TRUNC(
		    EXTRACT(DAY FROM A.PLUS_WORK_TIME)) || '일 ' ||
		    EXTRACT(HOUR FROM A.PLUS_WORK_TIME) || '시 ' ||
		    EXTRACT(MINUTE FROM A.PLUS_WORK_TIME) || '분 ' ||
		    EXTRACT(SECOND FROM A.PLUS_WORK_TIME) || '초' AS PLUS_WORK_TIME
		    ,TO_CHAR(A.CHECK_OUT_TIME - A.CHECK_IN_TIME + A.PLUS_WORK_TIME, 'HH24:MI:SS') AS TOTAL_WORK_TIME
		    ,A.OBJECTION_REASON
		    ,A.APPROVAL_STATUS
		    ,AC.TYPE AS TYPE
		    ,U.NAME AS NAME
		FROM ATTENDANCE A
		JOIN "USER" U
		ON A.USER_NO = U.NO
		JOIN ATTENDANCE_CURRENT AC
		ON A.CURRENT_NO = AC.NO
		WHERE U.NO = 1
		
	</select>
  
</mapper>