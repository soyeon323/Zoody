<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="animal">
 
  	<insert id="enroll">
  	
  		INSERT ALL
		INTO "ANIMAL" ("NO", "CATEGORY_NO", "DEPARTMENT_NO", "PROFILE", "NICK_NAME", "FEILD")
		VALUES (SEQ_ANIMAL_NO.NEXTVAL, SEQ_CATEGORY_NO.NEXTVAL, #{departmentNo}, #{profile}, #{nickName}, #{feild})
		INTO "CATEGORY" ("CATEGORY_NO", "CLASSIFICATION_NO", "TASTE_NO", "HABITAT_NO", "ENDANGERED_RATING_NO", "NAME")
		VALUES (SEQ_CATEGORY_NO.NEXTVAL,#{animalClassificationNo},#{tasteNo},#{habitatNo},#{endangeredRatingNo},#{name})
		SELECT * FROM DUAL

  	</insert>
  	
  	
  	<select id="AnimalList" resultType="AnimalVo">
  		SELECT 
  		A.*
		, C.*
		FROM ANIMAL A
		JOIN CATEGORY C ON A.CATEGORY_NO = C.CATEGORY_NO
		WHERE A.STATUS = 'O'
		
  	</select>
  	
  	<select id="getAnimalListCnt">
  		 SELECT COUNT(NO)
		FROM "ANIMAL"
		WHERE STATUS = 'O';
  	</select>
  	
  	
  	<insert id="trainingWrite">
  		INSERT INTO ANIMAL_TRAINING
			(
			    TRAINING_NO
			    , NO
			    , TITLE
			    , CONTENT
			)
			VALUES
			(
			    SEQ_ANIMAL_TRAINING_NO.NEXTVAL
			    ,#{no}
			    ,#{title}
			    ,#{content}
			)
  	
  	</insert>
  	
  	<insert id="healthWrite">
  		INSERT INTO ANIMAL_HEALTH_SCREENING
			(
			    NO
			    ,ANIMAL_NO
			    ,STATE_OF_HEALTH
			    ,CONTENT
			    ,DISEASE
			    ,LIFE_STYLE_MANAGEMENT
			)
			VALUES
			(
			    SEQ_ANIMAL_HEALTH_SCREENING_NO.NEXTVAL
			    ,#{animalNo}
			    ,#{stateOfHealth}
			    ,#{content}
			    ,#{disease}
			    ,#{lifeStyleManagement}
			)
  	</insert>
  	
  	<!-- A.DATE 만 붙히면 실행이 안됨;;; -->
  	<select id="animalDetail" resultType="AnimalVo">
  		SELECT 
		  A.NO
		, A.CATEGORY_NO
		, A.PROFILE
		, A.DEPARTMENT_NO
		, A.NICK_NAME
		
		, A.FEILD
		, C.CATEGORY_NO 
		, C.CLASSIFICATION_NO 
		, C.TASTE_NO
		, C.HABITAT_NO
		, C.ENDANGERED_RATING_NO
		, C.NAME
		FROM ANIMAL A
		JOIN CATEGORY C ON A.NO = C.CATEGORY_NO
		WHERE A.NO =#{no}

  	</select>
  	
  </mapper>